{"stages": [{"name": "Build something", "when": {"branch": "master", "event": ["push", "pull_request"]}, "steps": [{"runScriptConfig": {"image": "busybox", "shellScript": "echo ${FIRST_KEY} && echo ${ALIAS_ENV}"}, "env": {"FIRST_KEY": "VALUE", "SECOND_KEY": "VALUE2"}, "envFrom": [{"sourceName": "my-secret", "sourceKey": "secret-key", "targetKey": "ALIAS_ENV"}]}, {"runScriptConfig": {"image": "busybox", "shellScript": "date -R"}, "when": {"branch": ["master", "dev"], "event": "push"}}]}, {"name": "Publish my image", "steps": [{"publishImageConfig": {"dockerfilePath": "./Dockerfile", "buildContext": ".", "tag": "rancher/rancher:v2.0.0", "pushRemote": true, "registry": "reg.example.com"}}]}, {"name": "Deploy some workloads", "steps": [{"applyYamlConfig": {"path": "./deployment.yaml"}}]}], "branch": {"include": ["master", "feature/*"], "exclude": ["dev"]}, "timeout": 30, "notification": {"recipients": [{"recipient": "#mychannel", "notifier": "c-wdcsr:n-c9pg7"}, {"recipient": "test@example.com", "notifier": "c-wdcsr:n-lkrhd"}], "condition": ["Failed", "Success", "Changed"], "message": "my-message"}}